#!/bin/bash

gm_start_activity() {
  local activity="$1"
  adb shell am start -n com.greenmile.android/com.greenmile.android.activity.$activity
}

gm_install_release_apk() {
  adb install $HOME/Projects/gm-driver-android/driver/greenmile-android/build/outputs/apk/greenmile-android-release-$1.apk
}

run_query() {
  local file=$1
  local query=$2

  echo $query | sqlite3 $file
  echo $query | sqlite3 $file | pbcopy

  info "=====> Result copied to clipboard :) <====="
}

gm_run_query() {
  local query=$1

  run_query $HOME/Documents/banco_devices/greenmile.db $query
}

gm_run_query_device() {
  local query=$1

  gm_get_data_device
  gm_run_query $query
}

gm_run_query_requests() {
  gm_run_query_device "SELECT * FROM request;"
}

gm_branches() {
  local project

  info "Type the project:"
  read project

  open https://github.com/greenmilellc-org/$project/branches
}

gm_branches_compare() {

  local project
  local branch

  info "Type the project:"
  read project

  info "Type the branch:"
  read branch


  open https://github.com/greenmilellc-org/$project/compare/$branch
}

gm_branches_compare_range() {

  local project
  local first_branch
  local second_branch

  info "Type the project:"
  read project

  info "Type the first branch:"
  read first_branch

  info "Type the second branch:"
  read second_branch


  open https://github.com/greenmilellc-org/$project/compare/$first_branch...$second_branch
}

gm_commits() {

  local project
  local branch
  local author

  info 'Type the project:'
  read project

  info 'Type the branch:'
  read branch

  info 'Type the author:'
  read author

  open https://github.com/greenmilellc-org/$project/commits/$branch\?author\=$author
}


gm_uninstall_all() {
  info 'Available Devices'
  adb devices

  info 'Uninstalling GM Driver Integration Example'
  adb uninstall integration.greenmile.com.gm_driver_integration

  info 'Uninstalling GM Driver JS'
  adb uninstall com.greenmile.driver

  info 'Uninstalling GM Manager'
  adb uninstall com.greenmile.manager

  info 'Uninstalling GM Updater'
  adb uninstall com.greenmile.updater

  info 'Uninstalling GM Driver'
  adb uninstall com.greenmile.android

  info 'Deleting GreenMile folder from sdcard'
  adb shell rm -rf /sdcard/Greenmile

  info 'Deleting GreenMile APK from data folder'
  rm /data/app/com.greenmile.android-1.apk

  info 'Deleting GreenMile from data folder'
  rm /data/data/com.greenmile.android

  info 'Searching for greenmile on device'
  adb shell lsof | grep greenmile

  info 'Done ;)'
}
